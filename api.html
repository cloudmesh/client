

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API &mdash; cloudmesh_client 2.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="cloudmesh_client 2.1.0 documentation" href="index.html"/>
        <link rel="next" title="Hacking" href="hacking.html"/>
        <link rel="prev" title="Exercises" href="exercises.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> cloudmesh_client
          

          
          </a>

          
            
            
              <div class="version">
                2.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prefix.html">Prefix</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">Short Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference_card.html">Reference Card</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Example Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="comet.html">Comet Virtual Cluster</a></li>
</ul>
<p class="caption"><span class="caption-text">User Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="man/man.html">Commands</a></li>
</ul>
<p class="caption"><span class="caption-text">Teaching</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exercises.html">Exercises</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Manuals</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cloud-database">Cloud Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-an-element-in-the-database">Updating an element in the database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hacking.html">Hacking</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
</ul>
<p class="caption"><span class="caption-text">Future and Old</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Code</span></p>
<ul class="simple">
</ul>
<p class="caption"><span class="caption-text">Todo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="todo.html">ToDos</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">cloudmesh_client</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>API</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/api.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="cloud-database">
<h2>Cloud Database<a class="headerlink" href="#cloud-database" title="Permalink to this headline">¶</a></h2>
<p>Cloudmesh contains a convenient Cloud database to store its
objects. It also contains simple functions to synchronize the database
with objects that are found in clouds. This includes images, flavors,
and virtual machines.</p>
<p>The clouds are defined in ~/.cloudmesh/cloudmesh.yaml</p>
<p>All you need to do is to create a cm object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cm</span> <span class="o">=</span> <span class="n">CloudmeshDatabase</span><span class="p">(</span><span class="n">cm_user</span><span class="o">=</span><span class="s2">&quot;gregor&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To update a specific set of cloud object such as the flavors on the
cloud india you simply can say:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;flavor&quot;</span><span class="p">,</span> <span class="s2">&quot;india&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Other examples include</p>
<blockquote>
<div>cm.update(&#8220;image&#8221;, &#8220;india&#8221;)
cm.update(&#8220;vm&#8221;, &#8220;india&#8221;)</div></blockquote>
<p>Multiple updates and clouds can be introduced with a parametrized call:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;vm,flavor,image&quot;</span><span class="p">,</span> <span class="s2">&quot;india,aws,azure&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In our example all clouds specified update the virtual machines,
images, and flavors in the database.  Please note that the keywords
used are singular.</p>
<p>Once the data is in the database its easy to query it either with the
native query functions or with specialized find functions exposed to
the cm object.</p>
<p>To query for example a vm with the name &#8220;gregor-001&#8221; you can use</p>
<blockquote>
<div>vm = cm.find(&#8220;vm&#8221;, name=&#8221;gregor-001&#8221;).first()</div></blockquote>
<p>Using the method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">d</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">o_to_d</span><span class="p">(</span><span class="n">vm</span><span class="p">)</span>
</pre></div>
</div>
<p>returns a dict in the object d. Alternatively you could also use the
native database format and for example get information via:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">vm</span><span class="o">.</span><span class="n">name</span>
<span class="n">vm</span><span class="o">.</span><span class="n">status</span>
<span class="o">....</span>
</pre></div>
</div>
<p>In some cases using dicts is more convenient. You may want to chose if
you use the native form or the dict representation.</p>
</div>
<div class="section" id="updating-an-element-in-the-database">
<h2>Updating an element in the database<a class="headerlink" href="#updating-an-element-in-the-database" title="Permalink to this headline">¶</a></h2>
<p>The cloud related data have a number of attributes that make it easy
to identify them.  The most important one is &#8216;cm_id` which presents in
human readable format a unique id for the object in the database.</p>
<p>The id is generated fir the <cite>getID</cite> method.</p>
<p>Let us assume the following setup for our example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cm</span> <span class="o">=</span> <span class="n">CloudmeshDatabase</span><span class="p">(</span><span class="n">cm_user</span><span class="o">=</span><span class="s2">&quot;gregor&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>this will create a cm database object in which the user <cite>gregor</cite>
stores its values.  First we need to get a dictionary that we may want
to store and modify in the database.  We can obtain such an object
changeme from a live cloud with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cloud</span> <span class="o">=</span> <span class="n">OpenStack_libcloud</span><span class="p">(</span>
    <span class="s2">&quot;acloudnamedefinedin_cludmesh.yaml&quot;</span><span class="p">,</span>
    <span class="n">cm_user</span><span class="o">=</span><span class="s2">&quot;yourusernameonthecloud&quot;</span><span class="p">)</span>
<span class="n">flavors</span> <span class="o">=</span> <span class="n">cloud</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="s2">&quot;flavor&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">)</span>

<span class="n">internal_id</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>

<span class="n">changeme</span> <span class="o">=</span> <span class="n">flavors</span><span class="p">[</span><span class="n">internal_id</span><span class="p">]</span>
</pre></div>
</div>
<p>However such an object could also be created by hand. To store the
element in the database we first need to generate a unique cm_id. In
our case we use the cloud object type (here flavor), the unique
internal id that we obtain for each flavor, and the name of the cloud
on which the object belongs to.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">changeme</span><span class="p">[</span><span class="s2">&quot;cm_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">getID</span><span class="p">(</span><span class="s2">&quot;flavor&quot;</span><span class="p">,</span> <span class="n">internal_id</span><span class="p">,</span> <span class="s2">&quot;india&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Just to be sure lest set the type to flavor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">changeme</span><span class="p">[</span><span class="s2">&quot;cm_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;flavor&quot;</span>
</pre></div>
</div>
<p>Now let us change the label of the object to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">changeme</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;newlabel&quot;</span>
</pre></div>
</div>
<p>To update the new object to the database use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cm</span><span class="o">.</span><span class="n">update_from_dict</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">cm</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hacking.html" class="btn btn-neutral float-right" title="Hacking" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="exercises.html" class="btn btn-neutral" title="Exercises" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Gregor von Laszewski.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>